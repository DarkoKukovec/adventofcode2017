g=t=>{B=t.C.map(t=>{t.W=t.W||g(t).reduce((s,c)=>s+c)+t.w;return t.W});t.W=B.reduce((s,c)=>s+c,0)+t.w;return B};b=w=>w.length?w.every(i=>i==w[0]):!0;module.exports=i=>{u=i.split('\n').map(l=>{[n,C]=l.split(' -> ');w=~~n.split('(')[1].slice(0,-1);return{n:n.split(/\s/).shift(),w,C:C?C.split(', '):[],W:0}}).map((t,_,T)=>{t.C=t.C.map(n=>T.find(x=>x.n==n));if(t.C.length==0)t.W=t.w;return t}).filter(t=>!b(g(t))).sort((a,b)=>a.W-b.W).shift().C;l=u.reduce((w,c)=>{w[c.W]=~~w[c.W]+1;return w},{});[a,c]=Object.keys(l).map(Number).sort((a,b)=>l[a]-l[b]);return u.find(x=>x.W==a).w-(a-c)}